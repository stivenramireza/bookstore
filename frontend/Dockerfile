FROM node:14

ENV HOST 0.0.0.0
ENV APP_DIR /app/

WORKDIR ${APP_DIR}
COPY package*.json ./

RUN npm install

COPY . ./

EXPOSE 3000

ENV BOOKSTORE_DOMAIN ${BOOKSTORE_DOMAIN}
ENV AWS_COGNITO_DOMAIN ${AWS_COGNITO_DOMAIN}
ENV AWS_COGNITO_CLIENT_ID ${AWS_COGNITO_CLIENT_ID}
ENV BOOKS_API ${BOOKS_API}
ENV ORDERS_API ${ORDERS_API}

RUN npm run build
CMD ["npm", "start"]
